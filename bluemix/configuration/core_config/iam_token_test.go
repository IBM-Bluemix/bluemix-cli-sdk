package core_config

import (
	"testing"

	"github.com/stretchr/testify/assert"
)

var TestData = []string{
	"eyJraWQiOiIyMDE3MTAzMC0wMDowMDowMCIsImFsZyI6IlJTMjU2In0.eyJpYW1faWQiOiJJQk1pZC0wNjAwMDFNTlIzIiwiaWQiOiJJQk1pZC0wNjAwMDFNTlIzIiwicmVhbG1pZCI6IklCTWlkIiwiaWRlbnRpZmllciI6IjA2MDAwMU1OUjMiLCJnaXZlbl9uYW1lIjoiSnVubGkiLCJmYW1pbHlfbmFtZSI6IldhbmciLCJuYW1lIjoiSnVubGkgV2FuZyIsImVtYWlsIjoid2FuZ2p1bmxAY24uaWJtLmNvbSIsInN1YiI6IndhbmdqdW5sQGNuLmlibS5jb20iLCJhY2NvdW50Ijp7ImJzcyI6IjY1Y2U4MDc0YzZjNjJiNTBmM2NmNjA1OGZlOGI5MjNlIn0sImlhdCI6MTUxNjE3MzI4MCwiZXhwIjoxNTE2MTc2ODgwLCJpc3MiOiJodHRwczovL2lhbS5ibHVlbWl4Lm5ldC9pZGVudGl0eSIsImdyYW50X3R5cGUiOiJ1cm46aWJtOnBhcmFtczpvYXV0aDpncmFudC10eXBlOmFwaWtleSIsInNjb3BlIjoib3BlbmlkIiwiY2xpZW50X2lkIjoiYngifQ.QdPdQWFR1TTFzQ-1JLDBgyG8avnJFZZEzR1oAvWBKGxPz88rK0CapzqT0AnOr-Ip-LLUXeVSKflNhjZblS7Aru8Wpg_HuF164U4wZv1SoiidDq-yC0d2XCm2JNORSzkXVMigaHCwdauzwZMwNETcEY-BzaEj2DEcbUY83ouYXzFJ8BeTN4UaxxRik0wZBI612Zau5rDpM04-ddMJVLPkXh1GMaVPv_MoIl-EsyVAwvpol8JPqZDHADtyK2qkxyNdaueR-xjquwJ-D4p6dJADsxJeTEi1VzxbIzQau9zwUKOt_TJWvs14dyS2Z0UKGanhRnc7tx3etvwgWPe3Mx-xEg",
	"Bearer eyJraWQiOiIyMDE3MTAzMC0wMDowMDowMCIsImFsZyI6IlJTMjU2In0.eyJpYW1faWQiOiJJQk1pZC0wNjAwMDFNTlIzIiwiaWQiOiJJQk1pZC0wNjAwMDFNTlIzIiwicmVhbG1pZCI6IklCTWlkIiwiaWRlbnRpZmllciI6IjA2MDAwMU1OUjMiLCJnaXZlbl9uYW1lIjoiSnVubGkiLCJmYW1pbHlfbmFtZSI6IldhbmciLCJuYW1lIjoiSnVubGkgV2FuZyIsImVtYWlsIjoid2FuZ2p1bmxAY24uaWJtLmNvbSIsInN1YiI6IndhbmdqdW5sQGNuLmlibS5jb20iLCJhY2NvdW50Ijp7ImJzcyI6IjY1Y2U4MDc0YzZjNjJiNTBmM2NmNjA1OGZlOGI5MjNlIn0sImlhdCI6MTUxNjE3MzI4MCwiZXhwIjoxNTE2MTc2ODgwLCJpc3MiOiJodHRwczovL2lhbS5ibHVlbWl4Lm5ldC9pZGVudGl0eSIsImdyYW50X3R5cGUiOiJ1cm46aWJtOnBhcmFtczpvYXV0aDpncmFudC10eXBlOmFwaWtleSIsInNjb3BlIjoib3BlbmlkIiwiY2xpZW50X2lkIjoiYngifQ.QdPdQWFR1TTFzQ-1JLDBgyG8avnJFZZEzR1oAvWBKGxPz88rK0CapzqT0AnOr-Ip-LLUXeVSKflNhjZblS7Aru8Wpg_HuF164U4wZv1SoiidDq-yC0d2XCm2JNORSzkXVMigaHCwdauzwZMwNETcEY-BzaEj2DEcbUY83ouYXzFJ8BeTN4UaxxRik0wZBI612Zau5rDpM04-ddMJVLPkXh1GMaVPv_MoIl-EsyVAwvpol8JPqZDHADtyK2qkxyNdaueR-xjquwJ-D4p6dJADsxJeTEi1VzxbIzQau9zwUKOt_TJWvs14dyS2Z0UKGanhRnc7tx3etvwgWPe3Mx-xEg",
}

func TestNewIAMTokenInfo(t *testing.T) {
	for _, token := range TestData {
		tokenInfo := NewIAMTokenInfo(token)
		assert.Equal(t, tokenInfo.UserEmail, "wangjunl@cn.ibm.com")
		assert.Equal(t, tokenInfo.IAMID, "IBMid-060001MNR3")
		assert.Equal(t, tokenInfo.Accounts.AccountID, "65ce8074c6c62b50f3cf6058fe8b923e")
	}
}
