package core_config

import (
	"testing"

	"github.com/stretchr/testify/assert"
)

var TestIAMTokenData = []string{
	"eyJraWQiOiIyMDE3MTAzMC0wMDowMDowMCIsImFsZyI6IlJTMjU2In0.eyJpYW1faWQiOiJJQk1pZC0wNjAwMDFNTlIzIiwiaWQiOiJJQk1pZC0wNjAwMDFNTlIzIiwicmVhbG1pZCI6IklCTWlkIiwiaWRlbnRpZmllciI6IjA2MDAwMU1OUjMiLCJnaXZlbl9uYW1lIjoiSnVubGkiLCJmYW1pbHlfbmFtZSI6IldhbmciLCJuYW1lIjoiSnVubGkgV2FuZyIsImVtYWlsIjoid2FuZ2p1bmxAY24uaWJtLmNvbSIsInN1YiI6IndhbmdqdW5sQGNuLmlibS5jb20iLCJhY2NvdW50Ijp7ImJzcyI6IjY1Y2U4MDc0YzZjNjJiNTBmM2NmNjA1OGZlOGI5MjNlIn0sImlhdCI6MTUxNjE3MzI4MCwiZXhwIjoxNTE2MTc2ODgwLCJpc3MiOiJodHRwczovL2lhbS5ibHVlbWl4Lm5ldC9pZGVudGl0eSIsImdyYW50X3R5cGUiOiJ1cm46aWJtOnBhcmFtczpvYXV0aDpncmFudC10eXBlOmFwaWtleSIsInNjb3BlIjoib3BlbmlkIiwiY2xpZW50X2lkIjoiYngifQ.QdPdQWFR1TTFzQ-1JLDBgyG8avnJFZZEzR1oAvWBKGxPz88rK0CapzqT0AnOr-Ip-LLUXeVSKflNhjZblS7Aru8Wpg_HuF164U4wZv1SoiidDq-yC0d2XCm2JNORSzkXVMigaHCwdauzwZMwNETcEY-BzaEj2DEcbUY83ouYXzFJ8BeTN4UaxxRik0wZBI612Zau5rDpM04-ddMJVLPkXh1GMaVPv_MoIl-EsyVAwvpol8JPqZDHADtyK2qkxyNdaueR-xjquwJ-D4p6dJADsxJeTEi1VzxbIzQau9zwUKOt_TJWvs14dyS2Z0UKGanhRnc7tx3etvwgWPe3Mx-xEg",
	"Bearer eyJraWQiOiIyMDE3MTAzMC0wMDowMDowMCIsImFsZyI6IlJTMjU2In0.eyJpYW1faWQiOiJJQk1pZC0wNjAwMDFNTlIzIiwiaWQiOiJJQk1pZC0wNjAwMDFNTlIzIiwicmVhbG1pZCI6IklCTWlkIiwiaWRlbnRpZmllciI6IjA2MDAwMU1OUjMiLCJnaXZlbl9uYW1lIjoiSnVubGkiLCJmYW1pbHlfbmFtZSI6IldhbmciLCJuYW1lIjoiSnVubGkgV2FuZyIsImVtYWlsIjoid2FuZ2p1bmxAY24uaWJtLmNvbSIsInN1YiI6IndhbmdqdW5sQGNuLmlibS5jb20iLCJhY2NvdW50Ijp7ImJzcyI6IjY1Y2U4MDc0YzZjNjJiNTBmM2NmNjA1OGZlOGI5MjNlIn0sImlhdCI6MTUxNjE3MzI4MCwiZXhwIjoxNTE2MTc2ODgwLCJpc3MiOiJodHRwczovL2lhbS5ibHVlbWl4Lm5ldC9pZGVudGl0eSIsImdyYW50X3R5cGUiOiJ1cm46aWJtOnBhcmFtczpvYXV0aDpncmFudC10eXBlOmFwaWtleSIsInNjb3BlIjoib3BlbmlkIiwiY2xpZW50X2lkIjoiYngifQ.QdPdQWFR1TTFzQ-1JLDBgyG8avnJFZZEzR1oAvWBKGxPz88rK0CapzqT0AnOr-Ip-LLUXeVSKflNhjZblS7Aru8Wpg_HuF164U4wZv1SoiidDq-yC0d2XCm2JNORSzkXVMigaHCwdauzwZMwNETcEY-BzaEj2DEcbUY83ouYXzFJ8BeTN4UaxxRik0wZBI612Zau5rDpM04-ddMJVLPkXh1GMaVPv_MoIl-EsyVAwvpol8JPqZDHADtyK2qkxyNdaueR-xjquwJ-D4p6dJADsxJeTEi1VzxbIzQau9zwUKOt_TJWvs14dyS2Z0UKGanhRnc7tx3etvwgWPe3Mx-xEg",
}

var TestUAATokenData = []string{
	"Bearer eyJhbGciOiJIUzI1NiIsImtpZCI6ImtleS0xIiwidHlwIjoiSldUIn0.eyJqdGkiOiJhZGFkNWYwYzQ0ZDI0ZDlkYmVhN2YyNGIzMDNmOWNhNyIsInN1YiI6IjY3ODdiMzM2LTAwNzUtNGYwYy1hZmZiLWUyOWZjMmVhZWI4OCIsInNjb3BlIjpbIm9wZW5pZCIsInVhYS51c2VyIiwiY2xvdWRfY29udHJvbGxlci5yZWFkIiwicGFzc3dvcmQud3JpdGUiLCJjbG91ZF9jb250cm9sbGVyLndyaXRlIl0sImNsaWVudF9pZCI6ImNmIiwiY2lkIjoiY2YiLCJhenAiOiJjZiIsImdyYW50X3R5cGUiOiJwYXNzd29yZCIsInVzZXJfaWQiOiI2Nzg3YjMzNi0wMDc1LTRmMGMtYWZmYi1lMjlmYzJlYWViODgiLCJvcmlnaW4iOiJ1YWEiLCJ1c2VyX25hbWUiOiJ3YW5nanVubEBjbi5pYm0uY29tIiwiZW1haWwiOiJ3YW5nanVubEBjbi5pYm0uY29tIiwiYXV0aF90aW1lIjoxNTE2MTczMjgxLCJpYXQiOjE1MTYxNzMyODEsImV4cCI6MTUxNjE3Njg4MCwiaXNzIjoiaHR0cHM6Ly91YWEubmcuYmx1ZW1peC5uZXQvb2F1dGgvdG9rZW4iLCJ6aWQiOiJ1YWEiLCJhdWQiOlsiY2xvdWRfY29udHJvbGxlciIsInBhc3N3b3JkIiwiY2YiLCJ1YWEiLCJvcGVuaWQiXX0.K-9HdMCrNdln81ewX_TQLR63F4wChz035G5KtMq9wkk",
}

func TestNewIAMTokenInfo(t *testing.T) {
	for _, token := range TestIAMTokenData {
		tokenInfo := NewIAMTokenInfo(token)
		assert.Equal(t, tokenInfo.UserEmail, "wangjunl@cn.ibm.com")
		assert.Equal(t, tokenInfo.IAMID, "IBMid-060001MNR3")
		assert.Equal(t, tokenInfo.Accounts.AccountID, "65ce8074c6c62b50f3cf6058fe8b923e")
	}
}

func TestUAATokenInfo(t *testing.T) {
	for _, token := range TestUAATokenData {
		tokenInfo := NewUAATokenInfo(token)
		assert.Equal(t, tokenInfo.Username, "wangjunl@cn.ibm.com")
		assert.Equal(t, tokenInfo.UserGUID, "6787b336-0075-4f0c-affb-e29fc2eaeb88")
	}
}
